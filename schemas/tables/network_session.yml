name: network_session
id: 189BC2EE-44BF-4A8A-A257-5521C67D457B
description: Event fields used to define network sessions.
entities:
- cloud
- user_agent
- device
- name: destination
  prefix:
  - dst
  attributes:
  - bytes
  - city
  - country
  - region
  - domain
  - host_fqdn
  - host_name
  - interface_name
  - interface_guid
  - ip_addr
  - latitude
  - longitude
  - mac_addr
  - port_number
  - packets
  - resource_id
  - resource_group
  - user_aadid
  - user_sid
  - user_name
  - user_upn
  - user_domain
  - zone
- name: destination_nat
  prefix:
  - dst_nat
  attributes:
  - ip_addr
  - port_number
- name: source
  prefix:
  - src
  attributes:
  - bytes
  - city
  - country
  - region
  - domain
  - host_fqdn
  - host_name
  - host_os
  - host_model
  - host_type
  - interface_name
  - interface_guid
  - ip_addr
  - latitude
  - longitude
  - mac_addr
  - port_number
  - packets
  - resource_id
  - resource_group
  - user_aadid
  - user_sid
  - user_name
  - user_upn
  - user_domain
  - zone
- name: source_nat
  prefix:
  - src_nat
  attributes:
  - ip_addr
  - port_number
- name: http
  prefix:
  - http
  attributes:
  - request_time
  - request_ver
  - response_time
  - response_ver
  - request_method
  - status_code
  - content_type
  - referrer_original
  - xff
- name: file
  prefix:
  - file
  attributes:
  - name
  - path
  - extension
  - mimeType
  - size
  - hash_sha1
  - hash_md5
  - hash_sha256
  - hash_sha512
- name: url
  prefix:
  - url
  attributes:
  - category
  - original
  - host_name
- name: network
  prefix:
  - network
  attributes:
  - application_protocol
  - bytes
  - direction
  - duration
  - packets
  - session_id
  - protocol
- name: event
  prefix:
  - event
  attributes:
  - count
  - endtime
  - message
  - start_time
  - severity
  - original_uid
  - time_ingested
  - uid
  - ip_addr
  - mac_addr
  - host_name
  - product
  - product_ver
  - resource_group
  - resource_id
  - report_url
  - vendor
- name: custom
  entities:
  - name: schema
    prefix:
    - schema
    attributes:
    - name: ver
      type: real
      description: Azure Sentinel Schema Version
      sample_value: '0.1'
  - name: icmp
    prefix:
    - icmp
    attributes:
    - name: code
      type: integer
      description: For an ICMP message, ICMP message type numeric value (RFC 2780 or RFC 4443).
      sample_value: 34
    - name: type
      type: string
      description: For an ICMP message, ICMP message type text representation (RFC 2780 or RFC 4443)
      sample_value: 'Destination Unreachable'
  - name: rule
    prefix:
    - rule
    attributes:
    - name: name
      type: string
      description: The name or ID of the rule by which DeviceAction was decided upon
      sample_value: 'Any Any Drop'
    - name: number
      type: string
      description: Matched rule number
      sample_value: 7
  - name: threat
    prefix:
    - threat
    attributes:
    - name: category
      type: string
      description: The category of a threat identified by a security system such as Web Security Gateway of an IPS and is associated with this network session.
      sample_value: 'Trojan'
    - name: id
      type: string
      description: The ID of a threat identified by a security system such as Web Security Gateway of an IPS and is associated with this network session.
      sample_value: 'tr.076'
    - name: name
      type: string
      description: The name of the threat or malware identified
      sample_value: 'Win32.Small.ahif(90603579)'
  - name: operation
    prefix:
    - op
    attributes:
    - name: name
      type: string
      description: The activity associated with the record. Possible specific values are determined by the relevant schema.
      sample_value: 'Traffic'
  - name: result
    prefix: 
    - result
    attributes:
    - name: reason_type
      type: string
      description: Reason for the result reported in ResultType
      sample_value: 'Traffic'
    - name: type
      type: string
      description: The result reported for the activity. Empty value when not applicable.
      sample_value: 'Success'