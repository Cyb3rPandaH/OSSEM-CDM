name: network_session
id: 189BC2EE-44BF-4A8A-A257-5521C67D457B
description: Event fields used to define network sessions.
entities:
- cloud
- hash
- user_agent
- device
- name: source_nat
  prefix:
  - src_nat
  attributes:
  - ip_addr
  - port_number
- name: destination_nat
  prefix:
  - dst_nat
  attributes:
  - ip_addr
  - port_number
- name: destination
  prefix:
  - dst
  attributes:
  - bytes
  - city
  - country
  - region
  - domain
  - host_fqdn
  - host_name
  - interface_name
  - interface_guid
  - mac_address
  - ip_addr
  - latitude
  - longitude
  - nat_port_number
  - port_number
  - packets
  - resource_id
  - resource_group
  - user_aadid
  - user_sid
  - user_name
  - user_upn
  - user_domain
  - zone
- name: source
  prefix:
  - src
  attributes:
  - bytes
  - city
  - country
  - region
  - domain
  - host_fqdn
  - host_name
  - interface_name
  - interface_guid
  - mac_address
  - ip_addr
  - latitude
  - longitude
  - nat_port_number
  - port_number
  - packets
  - resource_id
  - resource_group
  - user_aadid
  - user_sid
  - user_name
  - user_upn
  - user_domain
  - zone
- name: event
  prefix:
  - event
  attributes:
  - count
  - endtime
  - message
  - start_time
  - severity
  - original_uid
  - start_time
  - time_ingested
  - uid
- name: http
  prefix:
  - http
  attributes:
  - request_time
  - request_ver
  - response_time
  - response_ver
  - request_method
  - status_code
  - content_type
  - referrer_original
  - xff
- name: file
  prefix:
  - file
  attributes:
  - name
  - path
  - extension
  - mimeType
  - size
- name: url
  prefix:
  - url
  attributes:
  - category
  - original
  - host_name
- name: network
  prefix:
  - network
  attributes:
  - application_protocol
  - bytes
  - direction
  - duration
  - packets
  - session_id
  - protocol
- name: custom
  entities:
  - name: reporter
    prefix:
    - rptr
    attributes:
    - name: host_ip_addr
      type: ip
      description: The IP address of the device generating the record
      sample_value: 211.209.13.12
    - name: mac
      type: string
      description: The MAC address of the network interface of the reporting device from which the event was send
      sample_value: '06:10:9f:eb:8f:14'
    - name: host_name
      type: string
      description: The device name of the device generating the message
      sample_value: 'syslogserver1.contoso.com'
    - name: product
      type: string
      description: The product generating the event.
      sample_value: 'OfficeSharepoint'
    - name: product_ver
      type: string
      description: The version of the product generating the event
      sample_value: '0.2'
    - name: resource_group
      type: string
      description: The resource group to which the device generating the record belongs. This might be an AWS account, or an Azure subscription or Resource Group
      sample_value: 'DBVM'
    - name: resource_id
      type: string
      description: The resource ID of the device generating the message.
      sample_value: '/subscriptions/aaabbbcc-dddd-eeee-1234-1234567890ab/resourcegroups/shokobo/providers/microsoft.compute/virtualmachines/sysmachine'
    - name: report_url
      type: string
      description: url of the full analysis report, if applicable 
      sample_value: 'https://192.168.1.1/reports/ade-123-afa.log'
    - name: vendor
      type: string
      description: The vendor of the product generating the event
      sample_value: 'Microsoft'
  - name: schema
    prefix:
    - schema
    attributes:
    - name: Ver
      type: real
      description: Azure Sentinel Schema Version
      sample_value: '0.1'
  - name: icmp
    prefix:
    - icmp
    attributes:
    - name: code
      type: integer
      description: For an ICMP message, ICMP message type numeric value (RFC 2780 or RFC 4443).
      sample_value: 34
    - name: type
      type: string
      description: For an ICMP message, ICMP message type text representation (RFC 2780 or RFC 4443)
      sample_value: 'Destination Unreachable'
  - name: rule
    prefix:
    - rule
    attributes:
    - name: name
      type: string
      description: The name or ID of the rule by which DeviceAction was decided upon
      sample_value: 'Any Any Drop'
    - name: number
      type: string
      description: Matched rule number
      sample_value: 7
  - name: threat
    prefix:
    - threat
    attributes:
    - name: category
      type: string
      description: The category of a threat identified by a security system such as Web Security Gateway of an IPS and is associated with this network session.
      sample_value: 'Trojan'
    - name: id
      type: string
      description: The ID of a threat identified by a security system such as Web Security Gateway of an IPS and is associated with this network session.
      sample_value: 'tr.076'
    - name: name
      type: string
      description: The name of the threat or malware identified
      sample_value: 'Win32.Small.ahif(90603579)'
  - name: operation
    prefix:
    - op
    attributes:
    - name: name
      type: string
      description: The activity associated with the record. Possible specific values are determined by the relevant schema.
      sample_value: 'Traffic'
  - name: result
    prefix: 
    - result
    attributes:
    - name: reason_type
      type: string
      description: Reason for the result reported in ResultType
      sample_value: 'Traffic'
    - name: type
      type: string
      description: The result reported for the activity. Empty value when not applicable.
      sample_value: 'Success'
functions:
  - rename:
    - EventCreationTime: TimeGenerated
    - HttpRequestVersion: HttpRequestVer