title: Network Session Table
name: NetworkSession
id: 189BC2EE-44BF-4A8A-A257-5521C67D457B
description: Event fields used to define network sessions in an endpoint.
attributes:
- name: hash
- name: user_agent
- name: event
  include:
  - count
  - endtime
  - message
  - start_time
  - severity
  - original_uid
  - start_time
  - time_ingested
  - uid
- name: http
  include:
  - request_time
  - response_time
  - request_method
  - status_code
  - content_type
  - referrer_original
  - xff
- name: file
  include:
  - name
  - path
  - extension
  - mimeType
  - size
- name: url
  include:
  - UrlCategory
  - UrlOriginal
  - UrlHostName
- name: custom
  include:
    - name: rprt
      include:
        
  - name: RprtrHostIpAddr
    type: ip
    description: The IP address of the device generating the record
    sample_value: 211.209.13.12
  - name: RprtrMac
    type: string
    description: The MAC address of the network interface of the reporting device from which the event was send
    sample_value: '06:10:9f:eb:8f:14'
  - name: RprtrHostName
    type: string
    description: The device name of the device generating the message
    sample_value: 'syslogserver1.contoso.com'
  - name: RprtrProduct
    type: string
    description: The product generating the event.
    sample_value: 'OfficeSharepoint'
  - name: RprtrProductVer
    type: string
    description: The version of the product generating the event
    sample_value: '0.2'
  - name: RprtrResourceGroup
    type: string
    description: The resource group to which the device generating the record belongs. This might be an AWS account, or an Azure subscription or Resource Group
    sample_value: 'DBVM'
  - name: RprtrResourceId
    type: string
    description: The resource ID of the device generating the message.
    sample_value: '/subscriptions/aaabbbcc-dddd-eeee-1234-1234567890ab/resourcegroups/shokobo/providers/microsoft.compute/virtualmachines/sysmachine'
  - name: RprtrReportUrl
    type: string
    description: url of the full analysis report, if applicable 
    sample_value: 'https://192.168.1.1/reports/ade-123-afa.log'
  - name: RprtrVendor
    type: string
    description: The vendor of the product generating the event
    sample_value: 'Microsoft'
  - name: SchemaVer
    type: real
    description: Azure Sentinel Schema Version
    sample_value: '0.1'
  - name: NetworkApplicationProtocol
    type: string
    description: The application layer protocol used by the connection or session
    sample_value: 'https'
  - name: DstBytes
    type: integer
    description: The number of bytes sent from the destination to the source for the connection or session
    sample_value: 32455
  - name: SrcBytes
    type: integer
    description: The number of bytes sent from the source to the destination for the connection or session
    sample_value: 46536
  - name: NetworkBytes
    type: integer
    description: Number of bytes sent in both directions. If both BytesReceived and BytesSent exist, BytesTotal should equal their sum
    sample_value: 78991
  - name: NetworkDirection
    type: string
    description: The direction the connection or session, into or out of the organization
    sample_value: 'Outbound'
  - name: DstCity
    type: string
    description: The city associated with the destination IP address
    sample_value: 'Burlington'
  - name: DstCountry
    type: country
    description: The country associated with the destination IP address
    sample_value: 'USA'
  - name: DstHostName
    type: string
    description: The device name of the destination device
    sample_value: 'admin_desktop'
  - name: DstHostFqdn
    type: string
    description: The fully qualified domain name of the destination host
    sample_value: 'admin_desktop.DEMO.LOCAL'
  - name: DstDomain
    type: string
    description: The domain part of the fqdn
    sample_value: 'DEMO.LOCAL'
  - name: DstInterfaceName
    type: string
    description: The network interface used for the connection or session by the destination device
    sample_value: 'eth02'
  - name: DstInterfaceGuid
    type: guid
    description: GUID of the network interface which was used for authentication request 
    sample_value: '516a64e3-8360-4f1e-a67c-d96b3d52df54'
  - name: DstIpAddr
    type: ip
    description: The IP address of the connection or session destination
    sample_value: 200.200.200.200
  - name: DstLatitude
    type: real
    description: The latitude of the geographical coordinate associated with the destination IP address
    sample_value: 44.475833
  - name: DstMac
    type: string
    description: The MAC address of the network interface at which the connection or session terminated
    sample_value: '08:aa:ff:eb:8f:14'
  - name: DstPort
    type: integer
    description: The destination IP port
    sample_value: 80
  - name: DstRegion
    type: string
    description: The region within a country associated with the destination IP address
    sample_value: 'Vermont'
  - name: DstResourceId
    type: string
    description: The resource Id of the destination device
    sample_value: '/subscriptions/33333333-8888-4444-a115-aaaaaaaaaaaa/resourcegroups/shokobo/providers/microsoft.compute/virtualmachines/sysmachine2'
  - name: DstNatIpAddr
    type: ip
    description: If reported by an intermediary NAT device such as a firewall, the IP address used by the NAT device for communication with the source.
    sample_value: 10.1.1.14
  - name: DstNatPort
    type: integer
    description: If reported by an intermediary NAT device such as a firewall, the port used by the NAT device for communication with the source
    sample_value: 443
  - name: DstUserSid
    type: string
    description: The User ID of the identity associated with the session’s destination. Typically, the identity used to authenticate a server. See "data types" for details
    sample_value: 'S-1-5-21-1234561234-7890789078-1234567890-190'
  - name: DstUserAadid
    type: string
    description: The User Azure AD ID of the identity associated with the session’s destination.
    sample_value: '5e8b0f4d-2cd4-4e17-9467-b0f6a5c0c4d0'
  - name: DstUserName
    type: string
    description: The username of the identity associated with the session’s destination
    sample_value: 'johnd'
  - name: DstUserUpn
    type: string
    description: The UPN of the identity associated with the session’s destination
    sample_value: 'johnd@anon.com'
  - name: DstUserDomain
    type: string
    description: The domain or computer name of the account at the destination of the session
    sample_value: 'WORKGROUP'
  - name: DstZone
    type: string
    description: The network zone of the destination, as defined by the reporting device.
    sample_value: 'dmz'
  - name: DstLongitude
    type: real
    description: The longitude of the geographical coordinate associated with the destination IP address
    sample_value: -73.211944
  - name: DstResourceGroup
    type: string
    description: The ID of the group to which the destination device belongs. This might be an AWS account, or an Azure subscription or Resource Group
    sample_value: 'DatabaseVMs'
  - name: DvcAction
    type: string
    description: If reported by an intermediary device such as a firewall, the action taken by device.
    sample_value: 'allow'
  - name: DvcInboundInterface
    type: string
    description: If reported by an intermediary device such as a firewall, the network interface used by it for the connection to the source device
    sample_value: 'eth0'
  - name: DvcOutboundInterface
    type: string
    description: If reported by an intermediary device such as a firewall, the network interface used by it for the connection to the destination device.
    sample_value: 'Ethernet 4'
  - name: NetworkDuration
    type: integer
    description: The amount of time, in millisecond, for the completion of the network session or connection
    sample_value: 1500
  - name: IcmpCode
    type: integer
    description: For an ICMP message, ICMP message type numeric value (RFC 2780 or RFC 4443).
    sample_value: 34
  - name: IcmpType
    type: string
    description: For an ICMP message, ICMP message type text representation (RFC 2780 or RFC 4443)
    sample_value: 'Destination Unreachable'
  - name: DstPackets
    type: integer
    description: The number of packets sent from the destination to the source for the connection or session. The meaning of a packet is defined by the reporting device
    sample_value: 446
  - name: SrcPackets
    type: integer
    description: The number of packets sent from the source to the destination for the connection or session. The meaning of a packet is defined by the reporting device
    sample_value: 6478
  - name: NetworkPackets
    type: string
    description: Number of packets sent in both directions. If both PacketsReceived and PacketsSent exist, BytesTotal should equal their sum.
    sample_value: 69424
  - name: RuleName
    type: string
    description: The name or ID of the rule by which DeviceAction was decided upon
    sample_value: 'Any Any Drop'
  - name: RuleNumber
    type: string
    description: Matched rule number
    sample_value: 7
  - name: NetworkSessionId
    type: string
    description: The session identifier as reported by the reporting device. Typically, not available for connections.
    sample_value: 'S198_13_1_27_12321_D205_13_1_27_443_0012'
  - name: SrcCity
    type: string
    description: The city associated with the source IP address
    sample_value: 'Burlington'
  - name: SrcCountry
    type: country
    description: The country associated with the source IP address
    sample_value: 'USA'
  - name: SrcHostName
    type: string
    description: The device name of the source device
    sample_value: 'admin_desktop'
  - name: SrcHostFqdn
    type: string
    description: The fully qualified domain name of the host initiating the session
    sample_value: 'admin_desktop.DEMO.LOCAL'
  - name: SrcDomain
    type: string
    description: The domain part of the fqdn
    sample_value: 'DEMO.LOCAL'
  - name: SrcHostOs
    type: string
    description: The OS of the source device
    sample_value: 'iOS'
  - name: SrcHostModel
    type: string
    description: The model of the source device
    sample_value: 'Samsung Galaxy Note 10'
  - name: SrcHostType
    type: string
    description: The type of the source device
    sample_value: 'mobile'
  - name: SrcIntefaceName
    type: string
    description: The network interface used for the connection or session by the source device
    sample_value: 'eth01'
  - name: SrcInterfaceGuid
    type: guid
    description: GUID of the network interface used to send the packets
    sample_value: '5f5f5f5f-8360-4f1e-a67c-d96b3d52df54'
  - name: SrcIpAddr
    type: ip
    description: The IP address from which the connection or session originated
    sample_value: 122.12.53.192
  - name: SrcLatitude
    type: real
    description: The latitude of the geographical coordinate associated with the source IP address
    sample_value: 31.23246
  - name: SrcLongitude
    type: real
    description: The longitude of the geographical coordinate associated with the source IP address
    sample_value: -42.3561
  - name: SrcMac
    type: string
    description: The MAC address of the network interface from which the connection od session originated
    sample_value: '08:aa:ff:eb:8f:14'
  - name: SrcPort
    type: integer
    description: The IP port from which the connection originated. May not be relevant for a session comprising multiple connections.
    sample_value: 12341
  - name: SrcRegion
    type: string
    description: The region within a country associated with the source IP address
    sample_value: 'Vermont'
  - name: SrcResourceGroup
    type: string
    description: The ID of the group to which the source device belongs. This might be an AWS account, or an Azure subscription or Resource Group
    sample_value: 'Hosts'
  - name: SrcResourceId
    type: string
    description: The resource ID of the device generating the message
    sample_value: '/subscriptions/3c1bb38c-82e3-4f8d-a115-a7110ba70d05/resourcegroups/contoso77/providers/microsoft.compute/virtualmachines/syslogserver1'
  - name: SrcNatIpAddr
    type: ip
    description: If reported by an intermediary NAT device such as a firewall, the IP address used by the NAT device for communication with the destination
    sample_value: 12.56.23.12
  - name: SrcNatPort
    type: integer
    description: If reported by an intermediary NAT device such as a firewall, the port used by the NAT device for communication with the destination
    sample_value: 389
  - name: SrcUserSid
    type: string
    description: The user ID of the identity associated with the sessions source. Typically, user performing an action on the client. See "data types" for details
    sample_value: 'S-1-5-1445'
  - name: SrcUserAadid
    type: string
    description: The User Azure AD ID of the identity associated with the session’s source. 
    sample_value: '5e8b0f4d-2cd4-4e17-9467-b0f6a5c0c4d0'
  - name: SrcUserName
    type: string
    description: The username of the identity associated with the sessions source. Typically, user performing an action on the client. See "data types" for details.
    sample_value: 'mbrandt'
  - name: SrcUserUpn
    type: string
    description: UPN of the account initiating the session
    sample_value: 'bob@alice.com'
  - name: SrcUserDomain
    type: string
    description: The domain for the account initiating the session
    sample_value: 'SANTARCTICA'
  - name: SrcZone
    type: string
    description: The network zone of the source, as defined by the reporting device.
    sample_value: 'Tap'
  - name: NetworkProtocol
    type: string
    description: The IP protocol used by the connection or session. Typically, TCP, UDP or ICMP
    sample_value: 'tcp'
  - name: CloudAppName
    type: string
    description: The name of the destination application for an HTTP application as identified by a proxy
    sample_value: 'Facebook'
  - name: CloudAppId
    type: String
    description: The ID of the destination application for an HTTP application as identified by a proxy. This value is usually specific to the proxy used
    sample_value: '124'
  - name: CloudAppOperation
    type: string
    description: The operation the user performed in the context of the destination application for an HTTP application as identified by a proxy. This value is usually specific to the proxy used.
    sample_value: 'DeleteFile'
  - name: CloudAppRiskLevel
    type: string
    description: The risk level associated with an HTTP application as identified by a proxy. This value is usually specific to the proxy used.
    sample_value: 'High'
  - name: ThreatCategory
    type: string
    description: The category of a threat identified by a security system such as Web Security Gateway of an IPS and is associated with this network session.
    sample_value: 'Trojan'
  - name: ThreatId
    type: string
    description: The ID of a threat identified by a security system such as Web Security Gateway of an IPS and is associated with this network session.
    sample_value: 'tr.076'
  - name: ThreatName
    type: string
    description: The name of the threat or malware identified
    sample_value: 'Win32.Small.ahif(90603579)'
  - name: OperationName
    type: string
    description: The activity associated with the record. Possible specific values are determined by the relevant schema.
    sample_value: 'Traffic'
  - name: ResultReasonType
    type: string
    description: Reason for the result reported in ResultType
    sample_value: 'Traffic'
  - name: ResultType
    type: string
    description: The result reported for the activity. Empty value when not applicable.
    sample_value: 'Success'
functions:
  - rename:
    - EventCreationTime: TimeGenerated
    - HttpRequestVersion: HttpRequestVer